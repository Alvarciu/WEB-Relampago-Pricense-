{% extends "base.html" %}
{% block content %}

<style>
  table {
    width: 100%;
    border-collapse: collapse;
    font-family: Arial, sans-serif;
    margin-top: 1em;
  }

  th {
    background-color: #222;
    color: #fff;
    padding: 10px;
    text-align: left;
  }

  td {
    padding: 8px;
    border-bottom: 1px solid #ddd;
    vertical-align: middle;
  }

  tr:hover {
    background-color: #f9f9f9;
  }

  .estado-form {
    display: inline;
  }

  .estado-btn {
    padding: 6px 10px;
    font-size: 16px;
    border-radius: 8px;
    border: none;
    cursor: pointer;
    transition: transform 0.2s ease, opacity 0.2s;
    color: white;
  }

  .estado-btn:hover {
    transform: scale(1.05);
    opacity: 0.9;
  }

  .estado-pagado {
    background-color: #28a745;
  }

  .estado-moroso {
    background-color: #dc3545;
  }

  .detalle-link {
    text-decoration: none;
    color: #007bff;
  }

  .detalle-link:hover {
    text-decoration: underline;
  }
</style>

<h2>Pedidos registrados</h2>

<p>
  {% if config.pedidos_abiertos %}
    ‚úÖ Pedidos abiertos |
    <a href="{% url 'alternar_pedidos' %}">üîí Cerrar pedidos</a>
  {% else %}
    ‚ùå Pedidos cerrados |
    <a href="{% url 'alternar_pedidos' %}">üîì Abrir pedidos</a>
  {% endif %}
</p>
<p>
  <a href="{% url 'exportar_pedidos_excel' %}" style="text-decoration: none; color: black;">
    üì¶ Exportar pedidos a Excel
  </a>
</p>

<table>
  <thead>
    <tr>
      <th>ID</th>
      <th>Usuario</th>
      <th>Email</th>
      <th>Fecha</th>
      <th>Total</th>
      <th>Estado</th>
      <th>Acciones</th>
    </tr>
  </thead>
  <tbody>
    {% for pedido in pedidos %}
    <tr>
      <td>{{ pedido.id }}</td>
      <td>{{ pedido.usuario.name }}</td>
      <td>{{ pedido.usuario.email }}</td>
      <td>{{ pedido.fecha|date:"d/m/Y H:i" }}</td>
      <td>{{ pedido.total }} ‚Ç¨</td>
      <td>
        <form method="POST" action="{% url 'cambiar_estado_pedido' pedido.id %}" class="estado-form">
          {% csrf_token %}
          {% if pedido.pagado %}
            <button type="submit" class="estado-btn estado-pagado" title="Marcar como moroso">‚úî</button>
          {% else %}
            <button type="submit" class="estado-btn estado-moroso" title="Marcar como pagado">‚úñ</button>
          {% endif %}
        </form>
      </td>
      <td><a href="{% url 'detalle_pedido_admin' pedido.id %}" class="detalle-link">üîç Ver detalles</a></td>
    </tr>
    {% endfor %}
  </tbody>
</table>

{% endblock %}
