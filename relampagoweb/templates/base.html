{% load static %}
<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>Relámpago Pricense FC</title>

  <!-- Bootstrap 5 CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <!-- Bootstrap Icons -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet">
  <!-- Estilos propios -->
  <link rel="stylesheet" href="{% static 'css/estilos.css' %}">

  <!-- SweetAlert2 -->
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
</head>
<body>

  <!-- CABECERA SUPERIOR: Fondo negro -->
  <header style="display: flex; align-items: center; gap: 10px; margin-bottom: 0; background-color: black; color: white; padding: 10px 20px;">
    <img src="{% static 'img/escudo.png' %}" alt="Escudo" width="40">
    <h1 style="margin: 0; font-size: 1.5rem;">Relámpago Pricense FC</h1>
  </header>

  <!-- NAVBAR con menú -->
  <nav class="navbar px-4 py-2 mb-0" style="background-color: #d6d6d6; border-radius: 6px;">
    <div class="container-fluid d-flex justify-content-between align-items-center flex-wrap">
      {% if user.is_authenticated %}
        <div class="d-flex flex-wrap align-items-center gap-2">
          <span class="me-2">Bienvenido {{ user.name }}</span>
          <span>|</span>
          <a href="{% url 'tienda' %}" class="text-decoration-none text-dark">Tienda</a>
          <span>|</span>
          <a href="{% url 'carrito' %}" class="text-decoration-none text-dark">Carrito</a>
          {% if user.is_staff %}
            <span>|</span>
            <a href="{% url 'panel_pedidos' %}" class="text-decoration-none text-dark">📋 Panel de pedidos</a>
          {% endif %}
        </div>
        <div>
          <!-- Enlace que lanza la alerta -->
          <a href="#" class="text-decoration-none text-danger" onclick="confirmarLogout(event)">Cerrar sesión</a>
          <!-- Formulario oculto que se envía si el usuario confirma -->
          <form id="logout-form" method="post" action="{% url 'logout' %}" style="display: none;">
            {% csrf_token %}
          </form>
        </div>
      {% else %}
        <div class="d-flex flex-wrap align-items-center gap-2">
          <a href="{% url 'login' %}" class="text-decoration-none text-dark">Iniciar sesión</a>
          <span>|</span>
          <a href="{% url 'registro' %}" class="text-decoration-none text-dark">Registrarse</a>
        </div>
      {% endif %}
    </div>
  </nav>

  <hr>

  {% if config and not config.pedidos_abiertos %}
    <div class="alerta-pedidos">
      <div class="alerta-texto">🚨 Pedidos cerrados 🚨</div>
    </div>
  {% endif %}

  <!-- BLOQUE PRINCIPAL -->
  {% block content %}{% endblock %}

  <!-- Bootstrap JS -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

  <!-- Confirmación visual con SweetAlert -->
  <script>
    function confirmarLogout(event) {
      event.preventDefault();
      Swal.fire({
        title: '¿Estás seguro de que quieres cerrar sesión?',
        icon: 'warning',
        showCancelButton: true,
        confirmButtonColor: '#e74c3c',
        cancelButtonColor: '#ccc',
        confirmButtonText: 'Cerrar sesión',
        cancelButtonText: 'Cancelar',
        reverseButtons: true,
        background: '#fff',
        focusConfirm: false
      }).then((result) => {
        if (result.isConfirmed) {
          document.getElementById('logout-form').submit();
        }
      });
    }
  </script>
</body>
</html>
