{% extends "base.html" %}
{% block content %}
<h2>Tu carrito</h2>

{% if carrito %}
  <ul>
    {% for item in carrito %}
      <li>
        <img src="{{ item.imagen_url }}" width="100"><br>

        <form action="{% url 'editar_item_carrito' forloop.counter0 %}" method="post">
          {% csrf_token %}
          <strong>{{ item.nombre }}</strong><br>

          <label>Talla:</label>
          <select name="talla">
            <option value="S" {% if item.talla == 'S' %}selected{% endif %}>S</option>
            <option value="M" {% if item.talla == 'M' %}selected{% endif %}>M</option>
            <option value="L" {% if item.talla == 'L' %}selected{% endif %}>L</option>
            <option value="XL" {% if item.talla == 'XL' %}selected{% endif %}>XL</option>
          </select><br>

          {% if item.nombre_dorsal is not None %}
            <label>Nombre dorsal:</label>
            <input type="text" name="nombre_dorsal" value="{{ item.nombre_dorsal }}"><br>

            <label>N√∫mero dorsal:</label>
            <input type="number" name="numero_dorsal" value="{{ item.numero_dorsal }}"><br>
          {% endif %}

          <button type="submit">Guardar cambios</button>
        </form>

        <form action="{% url 'eliminar_del_carrito' forloop.counter0 %}" method="post" style="display:inline;">
          {% csrf_token %}
          <button type="submit">‚ùå Quitar</button>
        </form>
      </li>
      <hr>
    {% endfor %}
  </ul>

  <form action="{% url 'vaciar_carrito' %}" method="post">
    {% csrf_token %}
    <button type="submit" style="background-color: red; color: white;">Vaciar carrito üóëÔ∏è</button>
  </form>

  <p><strong>Total: {{ total }} ‚Ç¨</strong></p>
  <a href="#">Finalizar pedido (Stripe)</a>
{% else %}
  <p>Tu carrito est√° vac√≠o.</p>
{% endif %}

<a href="{% url 'tienda' %}">‚Üê Volver a la tienda</a>
{% endblock %}
